#!/bin/bash# PostgreSQL Setup Script for User Service# Usage: sudo ./setup-postgres.shset -eecho "ðŸ—„ï¸  Setting up PostgreSQL for User Service..."# ConfigurationDB_NAME="authdb"DB_USER="auth"DB_PASSWORD="${DB_PASSWORD:-authpassword}"# ColorsGREEN='\033[0;32m'YELLOW='\033[1;33m'RED='\033[0;31m'NC='\033[0m'log_info() {    echo -e "${GREEN}[INFO]${NC} $1"}log_warn() {    echo -e "${YELLOW}[WARN]${NC} $1"}log_error() {    echo -e "${RED}[ERROR]${NC} $1"}# Check if PostgreSQL is installedif ! command -v psql &> /dev/null; then    log_error "PostgreSQL is not installed. Installing..."    sudo apt-get update    sudo apt-get install -y postgresql postgresql-contribfi# Check if PostgreSQL is runningif ! sudo systemctl is-active --quiet postgresql; then    log_warn "PostgreSQL is not running. Starting..."    sudo systemctl start postgresql    sudo systemctl enable postgresqlfilog_info "PostgreSQL is running"# Create database and userlog_info "Creating database and user..."sudo -u postgres psql <<EOF-- Create databaseCREATE DATABASE $DB_NAME;-- Create userCREATE USER $DB_USER WITH PASSWORD '$DB_PASSWORD';-- Grant privilegesGRANT ALL PRIVILEGES ON DATABASE $DB_NAME TO $DB_USER;-- For PostgreSQL 15+, you need to explicitly grant schema privileges\c $DB_NAMEGRANT ALL ON SCHEMA public TO $DB_USER;GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO $DB_USER;GRANT ALL PRIVILEGES ON ALL SEQUENCES IN SCHEMA public TO $DB_USER;ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL ON TABLES TO $DB_USER;ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL ON SEQUENCES TO $DB_USER;-- Display databases\lEOFlog_info "âœ… PostgreSQL setup completed!"echolog_info "Database details:"echo "  DB_NAME: $DB_NAME"echo "  DB_USER: $DB_USER"echo "  DB_PASSWORD: $DB_PASSWORD"echo "  CONNECTION_STRING: postgres://$DB_USER:$DB_PASSWORD@localhost:5432/$DB_NAME?sslmode=disable"echolog_warn "âš ï¸  Please update your .env file with these credentials"