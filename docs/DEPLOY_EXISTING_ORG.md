# üîÑ –î–µ–ø–ª–æ–π –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π GitHub Organization

> –£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å Organization —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º –¥–µ–ø–ª–æ–µ–º –≤ –¥—Ä—É–≥–æ–º –ø—Ä–æ–µ–∫—Ç–µ

---

## ‚ö° –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (5 —à–∞–≥–æ–≤)

### 1Ô∏è‚É£ –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç—ã (–µ—Å–ª–∏ –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ)

–ï—Å–ª–∏ –¥–µ–ø–ª–æ–∏—Ç–µ –Ω–∞ —Ç–æ—Ç –∂–µ —Å–µ—Ä–≤–µ—Ä, –≥–¥–µ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥—Ä—É–≥–æ–π –ø—Ä–æ–µ–∫—Ç:

**`backend/env.example`:**

```env
SERVER_PORT=12410  # –í–∞—à –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –ø–æ—Ä—Ç
```

**`deploy/nginx/auth-service.conf`:**

```nginx
upstream auth_backend {
    server 127.0.0.1:12410;  # Backend –ø–æ—Ä—Ç
}

upstream auth_frontend {
    server 127.0.0.1:12411;  # Frontend –ø–æ—Ä—Ç
}

server {
    server_name auth.yourdomain.com;  # –ü–æ–¥–¥–æ–º–µ–Ω
    # ...
}
```

**`frontend/ecosystem.config.js`:**

```javascript
env: {
  PORT: 12411,  // Frontend –ø–æ—Ä—Ç
}
```

**`.github/workflows/deploy.yml`:**

```yaml
SERVER_PORT=12410 # –í —Å–µ–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è .env (—Å—Ç—Ä–æ–∫–∞ ~98)
```

---

### 2Ô∏è‚É£ Organization Secrets (–æ–±—â–∏–µ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤)

**GitHub Organization ‚Üí Settings ‚Üí Secrets ‚Üí New organization secret**

–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∏—Ö –µ—â–µ –Ω–µ—Ç:

```
SERVER_HOST=123.45.67.89
SERVER_USER=deploy
SSH_PRIVATE_KEY=<–≤–∞—à_—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π_ssh_–∫–ª—é—á>
```

üí° **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSH –∫–ª—é—á** –∏–∑ –¥—Ä—É–≥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞!

---

### 3Ô∏è‚É£ Repository Secrets (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–ª—è auth-service)

**–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Üí Settings ‚Üí Secrets ‚Üí New repository secret**

```
DB_NAME=authdb
DB_USER=auth
DB_PASSWORD=<–Ω–æ–≤—ã–π_—É–Ω–∏–∫–∞–ª—å–Ω—ã–π_–ø–∞—Ä–æ–ª—å>
DB_HOST=localhost
DB_PORT=5432

DISCORD_CLIENT_ID=<—Å–æ–∑–¥–∞–π—Ç–µ_–Ω–æ–≤–æ–µ_discord_–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ>
DISCORD_CLIENT_SECRET=<secret_–Ω–æ–≤–æ–≥–æ_–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è>
DISCORD_REDIRECT_URI=https://auth.yourdomain.com/callback

JWT_SECRET=<openssl rand -base64 64>
FRONTEND_URL=https://auth.yourdomain.com
ADMIN_DISCORD_IDS=<–≤–∞—à_discord_user_id>
```

**‚ö†Ô∏è –°–æ–∑–¥–∞–π—Ç–µ –ù–û–í–û–ï Discord –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** (–Ω–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞—Ä–æ–µ!)

---

### 4Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
ssh deploy@YOUR_SERVER_IP

sudo -u postgres psql <<EOF
CREATE DATABASE authdb;
CREATE USER auth WITH PASSWORD 'PASSWORD_FROM_SECRETS';
GRANT ALL PRIVILEGES ON DATABASE authdb TO auth;
\c authdb
GRANT ALL ON SCHEMA public TO auth;
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO auth;
GRANT ALL PRIVILEGES ON ALL SEQUENCES IN SCHEMA public TO auth;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL ON TABLES TO auth;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL ON SEQUENCES TO auth;
EOF
```

---

### 5Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–¥–æ–º–µ–Ω –∏ –¥–µ–ø–ª–æ–π—Ç–µ

**DNS (—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞):**

```
Type: A
Name: auth
Value: YOUR_SERVER_IP
```

**Git:**

```bash
git add .
git commit -m "Setup deployment for existing organization"
git push origin main
```

GitHub Actions —Ä–∞–∑–≤–µ—Ä–Ω—ë—Ç backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏! ‚úÖ

**–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è, –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```bash
ssh deploy@YOUR_SERVER_IP

# Nginx
sudo cp /home/deploy/auth-service/deploy/nginx/auth-service.conf \
       /etc/nginx/sites-available/auth-service
sudo ln -s /etc/nginx/sites-available/auth-service \
           /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx

# SSL
sudo certbot --nginx -d auth.yourdomain.com

# Frontend
cd /home/deploy/auth-service/frontend
npm install
pm2 start ecosystem.config.js
pm2 save
```

---

## üìä –ß–µ–∫-–ª–∏—Å—Ç

- [ ] –ò–∑–º–µ–Ω–∏–ª –ø–æ—Ä—Ç—ã –≤ 4 —Ñ–∞–π–ª–∞—Ö (–µ—Å–ª–∏ –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ)
- [ ] –î–æ–±–∞–≤–∏–ª Organization Secrets (–æ–±—â–∏–µ)
- [ ] –î–æ–±–∞–≤–∏–ª Repository Secrets (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ)
- [ ] –°–æ–∑–¥–∞–ª –Ω–æ–≤–æ–µ Discord –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] –°–æ–∑–¥–∞–ª –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- [ ] –ù–∞—Å—Ç—Ä–æ–∏–ª DNS (A-–∑–∞–ø–∏—Å—å –¥–ª—è auth)
- [ ] –°–¥–µ–ª–∞–ª push –≤ main
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –¥–µ–ø–ª–æ–π –≤ GitHub Actions
- [ ] –ù–∞—Å—Ç—Ä–æ–∏–ª Nginx –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- [ ] –ü–æ–ª—É—á–∏–ª SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- [ ] –ó–∞–ø—É—Å—Ç–∏–ª Frontend —á–µ—Ä–µ–∑ PM2
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —Ä–∞–±–æ—Ç—É: `curl https://auth.yourdomain.com/health`

---

## üéØ –ö—Ä–∞—Ç–∫–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä       | –ü—Ä–æ–µ–∫—Ç 1          | Auth Service (—ç—Ç–æ—Ç)      |
| -------------- | ----------------- | ------------------------ |
| Backend –ø–æ—Ä—Ç   | 8080              | **8081**                 |
| Frontend –ø–æ—Ä—Ç  | 3000              | **3001**                 |
| –î–æ–º–µ–Ω          | yourdomain.com    | **auth.yourdomain.com**  |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö    | project1_db       | **authdb**               |
| DB user        | project1_user     | **auth**                 |
| Systemd —Å–µ—Ä–≤–∏—Å | project1.service  | **auth-service.service** |
| PM2 –ø—Ä–æ—Ü–µ—Å—Å    | project1-frontend | **auth-frontend**        |
| Discord OAuth  | App 1             | **App 2 (–Ω–æ–≤–æ–µ!)**       |

---

## ‚úÖ –ß—Ç–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

- ‚úÖ SSH –∫–ª—é—á (—á–µ—Ä–µ–∑ Organization Secrets)
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å deploy
- ‚úÖ PostgreSQL —Å–µ—Ä–≤–µ—Ä (–Ω–æ–≤–∞—è –ë–î)
- ‚úÖ Nginx (–Ω–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥)
- ‚úÖ Node.js & PM2

## ‚ùå –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω–æ

- ‚ùå –ü–æ—Ä—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- ‚ùå –ò–º–µ–Ω–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚ùå –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚ùå Discord OAuth –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- ‚ùå JWT Secret
- ‚ùå –î–æ–º–µ–Ω/–ø–æ–¥–¥–æ–º–µ–Ω

---

## üÜò –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### –ù—É–∂–Ω–æ –ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å server-quick-setup.sh?

‚ùå **–ù–µ—Ç!** –°–µ—Ä–≤–µ—Ä —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ü—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –ë–î.

### –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ SSH –∫–ª—é—á?

‚úÖ **–î–∞!** –î–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –∫–∞–∫ Organization Secret, –æ–±–∞ –ø—Ä–æ–µ–∫—Ç–∞ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

### –ù—É–∂–Ω–æ –ª–∏ –Ω–æ–≤–æ–µ Discord –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ?

‚úÖ **–î–∞!** –ö–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Å–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º Redirect URI.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤

```bash
ssh deploy@server
sudo netstat -tulpn | grep LISTEN

# –ó–∞–Ω—è—Ç–æ:
# :8080 - project1 backend
# :3000 - project1 frontend
#
# –°–≤–æ–±–æ–¥–Ω–æ –¥–ª—è auth-service:
# :8081 - backend
# :3001 - frontend
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- [–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](./DEPLOYMENT.md)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](./STRUCTURE.md)
- [–ö–æ–º–∞–Ω–¥—ã](./COMMANDS.md)

---

**üí° –ì–ª–∞–≤–Ω–æ–µ:** –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç—ã ‚Üí –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Organization Secrets ‚Üí Push –≤ main!
