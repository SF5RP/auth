# üìù –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –≤—ã —É–∂–µ –∑–∞–ø—É—Å–∫–∞–ª–∏ —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–æ–µ–∫—Ç–∞, –≤–∞–º –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

## –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∑–∞–Ω–æ–≤–æ:

```bash
go run cmd/migrator/main.go up
```

–ú–∏–≥—Ä–∞—Ü–∏–∏ —É–º–Ω—ã–µ - –æ–Ω–∏ –ø—Ä–∏–º–µ–Ω—è—Ç —Ç–æ–ª—å–∫–æ —Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã—Ö –µ—â–µ –Ω–µ—Ç –≤ –ë–î.

## –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ SQL

–ï—Å–ª–∏ –≤—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ —Ä—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL:

```sql
-- –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ discriminator
ALTER TABLE users ADD COLUMN IF NOT EXISTS discriminator VARCHAR(10) NOT NULL DEFAULT '0';
```

## –í–∞—Ä–∏–∞–Ω—Ç 3: –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –ë–î —Å –Ω—É–ª—è

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ!

```bash
# –û—Ç–∫–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
go run cmd/migrator/main.go down

# –ü—Ä–∏–º–µ–Ω—è–µ–º –∑–∞–Ω–æ–≤–æ
go run cmd/migrator/main.go up
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã:

```sql
\d users  -- –í psql
```

–ò–ª–∏ —á–µ—Ä–µ–∑ SQL:

```sql
SELECT column_name, data_type, is_nullable, column_default
FROM information_schema.columns
WHERE table_name = 'users'
ORDER BY ordinal_position;
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:

- id (integer)
- discord_id (varchar)
- username (varchar)
- **discriminator (varchar)** ‚Üê –Ω–æ–≤–æ–µ –ø–æ–ª–µ
- avatar (text)
- role (varchar)
- created_at (timestamp)

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Docker

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Docker:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞ (–º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ backend)
docker-compose up -d
```

## –ü—Ä–æ–±–ª–µ–º—ã?

### "column already exists"

–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - –∑–Ω–∞—á–∏—Ç –ø–æ–ª–µ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ä–∞–±–æ—Ç—É.

### "relation does not exist"

–í–æ–∑–º–æ–∂–Ω–æ, –ë–î –Ω–µ –±—ã–ª–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
go run cmd/migrator/main.go up
```

### –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –≤ `config.env`:

```env
DB_HOST=localhost
DB_PORT=5432
DB_USER=auth
DB_PASSWORD=authpassword
DB_NAME=authdb
```

## –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ë–î:

1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend:

   ```bash
   go run main.go
   ```

2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ frontend:

   ```bash
   cd frontend
   npm run dev
   ```

3. –í–æ–π–¥–∏—Ç–µ –∑–∞–Ω–æ–≤–æ —á–µ—Ä–µ–∑ Discord

–ì–æ—Ç–æ–≤–æ! üéâ

