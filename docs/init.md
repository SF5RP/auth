# Auth-—Å–µ—Ä–≤–∏—Å (Go + Next.js)

## üéØ –¶–µ–ª—å

–ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:

- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Discord (OAuth2)
- Auth backend –Ω–∞ Go (API + JWT)
- Frontend –Ω–∞ Next.js (UI –¥–ª—è –ª–æ–≥–∏–Ω–∞, –ø—Ä–æ—Ñ–∏–ª—è, –∞–¥–º–∏–Ω–∫–∏)
- –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–æ–ª–µ–π –≤ –ë–î
- JWT-—Ç–æ–∫–µ–Ω—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

---

## üìê –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] ‚áÑ [Next.js (UI)] ‚áÑ [Go Auth API] ‚áÑ [Discord API]
‚áÖ
[Postgres/SQLite]

markdown
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

---

## üó∫Ô∏è Backend (Go)

### 1. –ö–∞—Ä–∫–∞—Å (–î–µ–Ω—å 1‚Äì2)

- [x] –§—Ä–µ–π–º–≤–æ—Ä–∫: Gin
- [x] –ú–∞—Ä—à—Ä—É—Ç—ã `/health`, `/login`, `/callback`
- [x] `.env` –¥–ª—è client_id / client_secret Discord
- [x] –õ–æ–≥–≥–µ—Ä

### 2. Discord OAuth2 (–î–µ–Ω—å 3‚Äì4)

- [x] `/login` ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ Discord
- [x] `/callback` ‚Üí –ø–æ–ª—É—á–∏—Ç—å `code`
- [x] –û–±–º–µ–Ω `code` –Ω–∞ `access_token`
- [x] –ó–∞–ø—Ä–æ—Å `/users/@me`
- [x] –°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 3. JWT (–î–µ–Ω—å 5‚Äì6)

- [x] Access-—Ç–æ–∫–µ–Ω (15 –º–∏–Ω)
- [x] Refresh-—Ç–æ–∫–µ–Ω (7 –¥–Ω–µ–π)
- [x] –†—É—á–∫–∞ `/refresh`
- [x] –ö–ª–µ–π–º—ã: `sub`, `role`, `exp`

### 4. –ë–î –∏ —Ä–æ–ª–∏ (–î–µ–Ω—å 7)

- [x] –¢–∞–±–ª–∏—Ü–∞ `users (id, discord_id, username, discriminator, avatar, role, created_at)`
- [x] –¢–∞–±–ª–∏—Ü–∞ `refresh_tokens (id, user_id, token, expires_at)`
- [x] –†–æ–ª–∏: `user`, `admin`, `moderator`

### 5. Middleware (–î–µ–Ω—å 8)

- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT –≤ `Authorization: Bearer`
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ `userId` –∏ `role` –≤ `context`
- [x] –û—à–∏–±–∫–∏ `401 Unauthorized`, `403 Forbidden`

### 6. API –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è –∏ –∞–¥–º–∏–Ω–∫–∏ (–î–µ–Ω—å 9‚Äì10)

- [x] `GET /me` ‚Üí —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- [x] `GET /admin/users` (admin) ‚Üí —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [x] `POST /admin/users/:id/role` (admin) ‚Üí —Å–º–µ–Ω–∞ —Ä–æ–ª–∏

---

## üó∫Ô∏è Frontend (Next.js)

### 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- [x] `/login` ‚Üí –∫–Ω–æ–ø–∫–∞ ¬´–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Discord¬ª (—Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ Go API `/login`)
- [x] `/profile` ‚Üí –Ω–∏–∫, –∞–≤–∞—Ç–∞—Ä, —Ä–æ–ª—å (—á–µ—Ä–µ–∑ `/me`)
- [x] –•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ cookies
- [x] `/callback` ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ OAuth callback

### 2. –ê–¥–º–∏–Ω–∫–∞

- [x] `/admin/users` ‚Üí —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [x] –ö–Ω–æ–ø–∫–∞ ¬´—Å–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å¬ª ‚Üí –∑–∞–ø—Ä–æ—Å `POST /admin/users/:id/role`
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ `admin` (–Ω–∞ –±—ç–∫–µ –∏ —Ñ—Ä–æ–Ω—Ç–µ)

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

- [x] –ü–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞ Go –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JWT
- [x] Next.js –∫–ª–∞–¥—ë—Ç —Ç–æ–∫–µ–Ω –≤ cookie
- [x] –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã ‚Üí —Å —ç—Ç–∏–º —Ç–æ–∫–µ–Ω–æ–º
- [x] Redux Toolkit –¥–ª—è auth state
- [x] React Query –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üì¶ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### Backend

- Go + Gin/Fiber
- `golang-jwt/jwt/v5`
- `gorm` + Postgres/SQLite
- `oauth2` (golang.org/x/oauth2)
- Dockerfile

### Frontend

- Next.js 15 (App Router)
- React Query –∏–ª–∏ SWR
- MUI/Chakra/AntD
- Cookie –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤

---

## ‚è±Ô∏è –°—Ä–æ–∫–∏

- Backend (Go) ‚Üí **~2 –Ω–µ–¥–µ–ª–∏**
- Frontend (Next.js) ‚Üí **~1 –Ω–µ–¥–µ–ª—è**
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç—ã ‚Üí **~3 –Ω–µ–¥–µ–ª–∏ —Å—É–º–º–∞—Ä–Ω–æ**

---

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

- –ï–¥–∏–Ω—ã–π –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ Discord
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≤—ã–¥–∞—á–∞ JWT
- –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- UI –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –õ—ë–≥–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
